
基于Spring Boot 框架的能源管理系统的设计与实现
分别存储在不同的数据表中。数据的分割减少了单个数据表的负载，提高了数据库的查询性能。Tomcat 服务器内置在Spring Boot 框架中，为系统运行提供基本环境，Spring框架是系统的核心组件。它负责收集、存储和分析能耗监测点的数据，接收和处理摘要，本文基于SpringBoot 框架设计并实现了一个能源管理系统。系统主要包括三层，自下而上依次为数据采集层、业务逻辑层和显示界面层。数据采集层基于RS-48电气标准和MODBUS 通信协议。这两个协议将所有能耗监测点连接到企业的混合拓扑通信网络中。数据采集层的程序对网络中的每个能耗监测点进行轮询，采集数据并传输到业务逻辑层。
业务逻辑层基于SpringBoot 框架开发，主要包括两部分，MySQL 数据库和Tomcat 服务器，在MySQL 数据库中，存储的数据按时间列横向分割，来自显示界面层的数据请求。它还为外部程序提供标准数据接口。显示界面层基于Vue 框架开发，并集成到Spring Boot 框架中。显示层结合了名为ECharts 的开源可视化图表库，为用户提供功能齐全、界面友好的人机交互界面。通过对硬件和软件成本的计算，并考虑到不同地区的人员成本，可以估算出能源管理系统的总成本。本文中的建设成本约为21万美元。该系统自201年1月在某制造企业实际部署以来，已稳定运行60多天。
关键词Spring Boot 框架；混合拓扑；水平数据库分割；Tomcat 服务器

1导言

能源是是工业发展的基础。现代企业，尤其是制造业，在生产过程中需要消耗大量的水、电等能源。这些高耗能企业每年都要付出高昂的能源成本，但能源利用率却得不到有效提高。高额的能源成本不仅影响了节能降耗，还削弱了企业的市场竞争力。建立能源管理体系，全面控制企业能源消耗总量，对提高能源利用率具有重要意义。在电力市场中，不同时期的电能需求波动较大，给电力系统带来巨大的负荷。需求响应已成为智能电网系统的重要组成部分。能源管理系统可以计算和分析能源消耗的，企业可根据分析结果确定能源消耗的峰谷期。企业可根据分析结果动态调整生产计划，削峰填谷，进一步降低能源成本，增加企业利润。同时，该系统还有助于实现能源供需平衡，确保电力市场稳定。
20世纪60年代中期，日本首先开始研究和开发能源管理系统，主要用于全国各地的钢铁厂。早期的能源管理系统规模较小，功能简单。它主要用于能耗数据的收集和监测，以及设备的控制。在以美国和德国为代表的发达国家，工业体系和社会体系都非常重视能耗的测量和控制，很多企业都有自己成熟的能源管理系统。美国福特汽车公司、美国通用汽车公司、德国西门子公司等都建立了各具特色的能耗管理平台，在节能降耗方面取得了巨大效益。中国的能源管理体系起步于2世纪8年代。中国重汽、上海汽车等制造企业积极建设能源管理系统，收集、处理、分析企业的能耗数据。这些企业还逐步建设能源管理中心，开展能耗优化工作。经过3多年的发展，能源管理状况得到了很大改善。
在传统的能源计量和管理系统中，各区域和设备的能耗主要依靠人工观察和记录。一些区域和设备的能耗只能估算，数据记录误差极大。数据汇总后人工复制，传输严重滞后。漏水、漏电等异常情况也难以及时发现和处理。手工记录的数据主要以手写和纸张存储为主，给区域能耗的定期分析带来诸多不便。
随着现代互联网技术的发展，服务器、数据库等技术逐渐应用到工业领域。人们希望从繁重的抄表任务中解脱出来，实现能耗数据的远程自动采集和存储，使能耗数据及时、准确，从而有效防止迟报、少报、数据造假等现象。企业管理者可以借助计算机完成复杂的计算任务，对能耗数据进行综合分析，及时发现问题并加以整改，最终提高能源利用率。
针对上述问题，本文设计并实现了基于Spring Boot 框架的能源管理系统。该系统结合现代互联网技术和工业数据采集技术，集数据采集、数据存储、实时监控、能耗分析、能耗预测等功能于一体。这些功能实现了对企业能源消耗的管理和控制，从而准确管理和分析各区域、各生产环节的能源消耗情况，并为企业管理者制定节能计划提供可靠、科学的依据。
2系统架构设计本文设计的能源管理系统基于Spring Boot 框架，集成了MySQL 数据库和Vue 前端框架。系统设计遵循三层架构原则，由三层组成：从下到上依次为数据采集层、业务逻辑层和显示界面层。
在图中所示的整个系统架构中，数据收集层将所有能耗监测点连接到一个通信网络中，轮询每个节点以收集原始数据，并将数据传输到业务逻辑层。业务逻辑层对接收到的数据进行解析并存储到数据库中。经过计算和分析后，Tomcat 服务器可为显示界面层提供数据服务。显示界面层用于显示数据分析结果，并提供人机交互界面。显示界面层和业务逻辑层均由Spring Boot 框架构建。
2.1数据收集层在企业和生产区域设置了许多能耗监测点，以监测区域或生产设施的能耗。
每个能耗监测点至少配备一个标准测量装置，如电能表、流量计和积算仪。电能表用于监测区域或设备的电能消耗、电压值和电流。流量计用于监测水的瞬时流量和累积流量。积算仪用于监测蒸汽或压缩空气的瞬时流量、累计流量以及气体的温度和压力。能耗监测点和标准计量装置可以准确反映企业和生产设施的能耗情况，因此得到了广泛应用。
RS-48是一种电气接口标准，广泛应用于工业控制领域的物理层连接。
RS-48通常使用A、B 两条信号线，采用差分信号传输，工作在半双工模式，最大传输距离为120米。RS-48支持多点连接，具有传输速率高、抗干扰性能好等特点。MODBUS-RTU 是一种开放式串行通信协议，现已成为通信协议的行业标准。它也是工业电子设备之间广泛使用的通信协议。MODBUS-RTU 协议基于主/从结构。主站向从站发送请求，从站用自己的数据回应主站。MODBUS-RTU协议规定了请求和响应的数据格式，并使用CRC 来确保数据的正确性和完整性。
数据收集层使用RS-48总线将所有能耗监测点连接成一个混合拓扑节点通信网络。通信网络结合了总线拓扑和星形拓扑。节点通信网络如图中所示。
图2.通信网络架构。
在图中所示的通信网络中，多个通信节点和中继器连接到RS-48总线上，所有通信节点共享RS-48公共总线。总线型拓扑结构简单，可靠性高。单个节点的故障不会影响总线与其他节点之间的通信。总线便于连接新的通信节点或中继器。中继器的主要功能是增强传输信号，延长传输距离，确保长距离传输时信号的稳定性和完整性。总线上的每个中继器都是星形网络的中心节点，可连接多个通信节点。中继器主要用于远离总线的能源监控组。RS-48集线器是通信网络的采集终端。采集终端通过串行转换器与计算机或服务器连接，串行转换器可将RS-48接口转换为RS-23或USB 接口。
采集终端是通信网络中唯一的主站，其他节点都是从站。每个从站都有一个唯一的MODBUS 地址，以区别于其他从站。中继器仅用于增强和转发信号，不用作通信节点。根据MODBUS 协议规定的数据格式，采集终端向通信网络发送请求，采集指定地址从站的数据。所有从站都会收到该请求。如果自己的地址与请求中的地址不同，则从站忽略该请求。如果地址相同，则从站向收集终端返回自己的数据。收集终端逐个轮询所有节点，收集网络中的数据。采集终端由计算机直接控制。系统会对返回的数据进行验证，以确保数据的完整性。如果验证失败或返回超时，则丢弃数据并重新传输请求。如果再次发生故障，系统会跳过该节点并记录发生时间。
2.2业务逻辑层业务逻辑层使用Spring Boot 框架构建，主要包括两部分：数据库和服务器。
数据库用于存储能耗数据和用户信息。服务器中运行的程序负责计算和分析数据，为显示界面层提供数据服务，并为其他用户或系统提供标准数据接口。
2.2.1数据库的设计数据库设计是指在给定的应用环境下，对数据库的逻辑模式和物理结构进行设计和优化。它建立一个数据库和应用系统，以有效地存储和管理数据。数据库中的数据根据一定的数据模型来组织、描述和存储。这样做有几个好处，如减少冗余、提高独立性和易于扩展。
MySQL 是一种关系数据库管理系统。这种数据库体积小，易于安装和维护。MySQL 是开源和免费的，有LAMP 和LNMP 等流行架构。MySQL 数据库以其卓越的性能和稳定的服务成为企业用户的首选。E-R（实体关系）图用于描述实体类型、属性和连接之间的关系。E-R 图是一种描述概念模型的方法，便于设计数据库的逻辑结构。本文数据库中的主要实体是用户、能耗监测点及其数据。
为了保证企业能源数据的连续性和准确性，数据采集层每天2小时从节点通信网络中采集数据。在系统实际运行过程中发现，RS-48通信平均，秒就能完成一个节点的数据采集，以此计算，每天产生4320条记录，每月产生129600条记录，每年产生1576800条记录。在系统设计寿命为2年的前提下，将产生数十亿条数据。在单个数据表中存储如此大量的数据将严重影响数据库的读写性能。
数据表拆分是指将存储在单个数据表中的数据按照一定的维度分布到多个数据表中，从而减少单个数据表的负载，提高性能。常见的数据库拆分方法包括垂直拆分和水平拆分。垂直拆分是将一个有很多属性的表按照不同的属性拆分成不同的表。拆分后每个表的结构都不同，每个表之间至少有一列交叉。横向拆分是指根据某一字段并按照一定的规则将表拆分成多个表。拆分后各表的结构相同，但各表的数据不同，没有交集。
本文设计的数据库采用了水平分割法。数据表中的数据根据时间字段进行拆分。每当时间列的值进入一个新的月份，数据就会被放入一个新的表中。这种方法实现了根据时间字段按月份分割数据表。例如，202年的数据被分散到1个表中。表，显示了每个表的数据量和错误率。
2.2.2Spring Boot 框架的应用在业务逻辑层，Spring Boot 框架是核心组件，负责收集、存储和分析数据收集层的数据。它还接收和处理来自显示界面层的数据请求，并为外部程序提供标准数据接口。
Spring Boot 框架是Spring 项目下的一个子项目，是目前最流行的Java 企业级开发框架。Spring Boot 框架内部集成了Tomcat 服务器，无需部署即可直接运行。Spring Boot 框架摒弃了传统框架中繁琐的XML 配置文件，而是基于注解进行开发。基于注解的开发简化了配置，大大降低了开发难度。在集成第三方框架时，Spring Boot 可以自动配
1.系统会查找名为@SpringBootApplication 的注解，并创建一个SpringApplication 的内部对象作为程序的主入口；确定应用程序的类型（本例中为网络应用程序）；所有初始化程序和监听器都已加载；2.3.4.5.设置应用程序参数和环境变量；准备上下文环境。这是Spring Boot 框架启动的核心步骤。第三方库的依赖关系、自动配置和内置服务器Tomcat 的启动都在这一步建立；执行用户定义的方法。这标志着Spring Boot 应用程序的完成，然后才能开始正常工作。
6.在步骤，中，Spring Boot 框架会加载所有监听器。监听器可以监听来自前端的数据请求，将请求转发给处理程序，并调用用户定义的业务处理函数来响应请求。在第，步，Spring Boot 框架启动内置的Tomcat 服务器，提供基本的运行环境，并加载第三方库和框架。界面显示层中的Vue 前端框架就是在这一步中集成的。在第，步，Spring Boot 应用程序执行用户定义的方法，完成数据库读写、数据处理和执行定时任务等多项任务。至此，Spring Boot 应用程序成功启动。
Spring Boot 的强大功能为开发人员提供了极大的便利。以数据查询功能为例。首先，我们在公有类DataController 中添加注解"@RestController"，以表明该类是一个控制类。然后，我们为类中的方法public String get，DataById (@PathVariableInteger id)添加注解"@RequestMapping("/getDataById/{id}")"。Spring Boot 框架会根据请求url 的地址自动映射到相应的方法，提取url 中的参数id，并将其提供给该方法供内部使用。最后，我们在方法体中编写特定的业务逻辑代码，例如执行SQL 语句并以字符串形式返回查询到的数据。至此，根据id 进行数据查询的功能开发完成。在Spring Boot 框架中，所有配置都在一个名为application.yaml 的文件中，即数据库驱动程序、登录名和密码。框架会自动加载配置文件并建立数据库连接。开发人员只需编写SQL 语句即可完成数据查询。
3显示界面层显示界面层用于显示业务逻辑层的数据分析结果。该层实现了登录、注册和查询等多项功能。它还提供了人机交互界面。显示层基于Vue 框架开发，结合开源可视化图表库ECharts，为用户提供一套功能齐全、操作便捷的前端显示界面。
Vue 是一个用于构建用户界面的渐进式框架。与其他单一的框架不同，Vue 从一开始就被设计为可逐步采用。它不仅易于使用，而且易于与第三方库或现有项目集成。根据MVVM（model-view-viewmodel）的设计思想，Vue 实现了数据和视图的双向绑定，降低了各部分的耦合度，使用起来更加灵活。Vue 框架可以直接集成到Spring Boot 框架中，Spring Boot 框架可以帮助完成自动配置。图中是Vue 框架的MVVM 模式示意图。
图5Vue 框架的MVVM 模式示意图。
ECharts 是一个基于JavaScript 的开源可视化库，涵盖各种行业图表。
它可以在桌面和移动终端上流畅运行，并兼容多种浏览器。ECharts 的介绍很简单。通过设置配置项，可以控制数据的呈现方式和视觉效果。ECharts 通过丰富的组件和高度个性化的可视化解决方案，实现用户与数据之间的互动，从而提高用户获取知识和优化数据分析的能力。
本系统使用Vue 前端框架和ECharts 设计了能源管理系统的网页显示界面。
在B/S 架构中，网络界面可通过浏览器访问，界面丰富，操作便捷。
2.4开发成本计算显示界面层用于显示业务逻辑层的数据分析结果。该层实现了登录、注册和查询等多项功能。它还提供了人机交互界面。
在数据采集层，能耗监测点和节点通信网络由各种硬件设备组成，建设成本相对较高。在能耗监测点，一个电能表的成本约为30美元。流量计有大口径和小口径两种。成本分别为40美元和25美元。一个累加器的成本约为15美元。在节点通信网络中，用于连接的双绞线屏蔽线每10米3美元。
该企业共部署了19台电能表、8台流量计（包括5台大口径流量计和2台小口径流量计）以及5台积算仪。总成本为约101,15美元。集线器、中继器和双绞线屏蔽电缆的总成本约为55,00美元。
在数据采集层，硬件设备的成本难以降低，因此需要花费大量资金。我们希望在软件层面，在保证安全性和功能性的前提下，适当降低成本。因此，以SpringBoot 为代表的开源框架应运而生。业务逻辑层和显示界面层广泛使用了各种开源框架和组件。MySQL 是高性能的开源数据库，Spring Boot 框架也是最流行的Java企业级开发框架。Vue 和Echarts 也是广泛使用的前端开源框架。无论是使用Spring Boot 还是Vue，从技术上讲，您都可以从社区获得大量的支持和帮助。
特别是，Spring Boot 框架在过去1年中一直由作者维护和更新，以确保安全性和稳定性。在这两层中，系统构建的成本主要来自雇佣开发人员以及软件调试和维护。
考虑到不同地区的差异和建设周期的长短，雇用工人和开发人员的成本也大不相同。在该项目中，人员成本约为500美元。整个能源管理系统的建设成本约为2100美元。
3系统运行和分析该能源管理系统于201年1月在某制造企业正式部署，目前已稳定运行60多天。图中显示了能源管理系统的大屏幕显示界面。
图6.大屏幕显示界面。
由于不在实际生产环境中，因此无法获得最新数据。图中数据为实验室环境下的模拟值。在图中，主界面显示了企业的电力、水和蒸汽消耗量。它还显示了不同月份的用电量和主要区域的能源消耗比例。界面左下角显示简短的报警信息。大屏幕显示器界面主要供来访者了解企业的能源管理情况。
图中显示了能源管理系统的后台界面。我们可以看到企业今天的能耗、昨天的能耗以及本月的累计能耗。同时，我们还可以通过设置时间范围来查看某段时间内的每日能耗。右侧的排名是该时间段内使用量最大的能耗监测点及其使用情况。能源管理系统的后台界面为企业管理者提供了数据可视化和分析功能。
图中显示了实时数据界面。
图8.实时数据接口。
从图中我们可以看到生产区能耗监测点的实时数据。电能监测点显示电耗，水和蒸汽能耗监测点显示瞬时流量和累计流量，蒸汽和压缩空气能耗监测点还记录了压力和温度。
图中显示了历史数据查询界面。以耗水量为例。在该界面中，可以查询单个或多个能耗监测点的用水量。
显示了设置界面。在此界面中，会显示所有警报信息，并可发送到特定的电子邮件或电话。管理人员可以更改自动打印报告的时间。
4结论本文设计并实现了一个基于Spring Boot 框架的能源管理系统，该系统已在实际生产环境中稳定运行了60多天。该系统采用三层架构：从下到上依次为数据采集层、业务逻辑层和显示界面层。数据采集层实时监控企业的所有能耗监测点，确保数据的完整性和连续性。在业务逻辑层，数据库采用横向拆分的方式，大大降低了单个表的数据负载。单个表的最大数据存储容量为1,296,00个，数据查询效率极高。Spring Boot 框架可提供稳定的数据服务，易于维护和扩展功能。在显示界面层，使用Vue 和ECharts 开发的显示界面功能丰富，操作简便。系统的各项功能都能正常、稳定地运行，为企业能耗的管理和控制提供了便利。在建设成本方面，硬件成本基于设备的数量和价格，人员成本基于工作时间。据此，可以估算出能源管理系统的总成本。在本文中，建设总成本约为2万美元。
该系统目前部署在企业内部服务器中，能源管理界面只能由同一局域网内的计算机访问网络。未来可将系统部署在云服务器中，实现手机端适配和增强身份认证，实现任何设备随时随地访问和管理系统。在节点通信网络方面，未来将采用5G 等无线传输技术，数据直接传输到云端服务器，减少数据的本地停留时间，避免可能的数据注入和篡改。针对云部署的数据安全问题，未来除了依托Spring Boot 的安全框架和定期的数据库备份外，系统还将加强登录用户的身份认证，记录用户的IP 地址和敏感操作行为，并在传输过程中进行数据传输。二次加密增加了数据破解的难度，从而提高了通信网络的稳定性和云系统的数据安全性。
